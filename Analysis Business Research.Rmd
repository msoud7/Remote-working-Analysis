---
title: "Analysis Business Research"
author: "Melle Stephen Oudshoorn"
date: "`r Sys.Date()`"
output: html_document
---

```{r loading packages message = FALSE, warning = FALSE}
library(dplyr)
library(readxl)
library(tidyr)
library(readr)
library(ggplot2)
library(ltm)
library(janitor)
```

```{r load and mutate data}
# Read in the data
data <- read_excel("Master File.xlsx")

# Clean column names to remove special characters
data <- janitor::clean_names(data)  # janitor::clean_names() makes all names lowercase, replaces spaces with underscores, etc.

# Define selected columns based on the cleaned names
selected_columns <- c("in_what_kind_of_place_do_you_typically_work",
                      "in_your_main_job_have_you_spent_at_least_one_full_day_in_the_last_four_weeks_working",
                      "how_frequently_did_you_work_from_home_in_the_last_four_weeks",
                      "i_currently_have_a_good_balance_between_the_time_i_spend_at_work_and_the_time_i_have_available_for_non_work_activities",
                      "i_have_sufficient_time_away_from_my_job_to_maintain_adequate_well_being",
                      "i_am_satisfied_with_my_work_life_balance",
                      "my_personal_life_suffers_because_of_work_43",
                      "when_i_get_home_i_am_often_too_exhausted_to_participate_in_family_activities",
                      "the_problem_solving_behaviours_i_use_in_my_job_are_not_effective_in_resolving_problems_at_home",
                      "the_time_i_spend_on_family_responsibilities_often_interferes_with_my_work",
                      "due_to_stress_at_home_i_am_often_preoccupied_with_family_matters_at_work",
                      "the_behaviours_that_work_for_me_at_home_do_not_seem_to_be_effective_at_work",
                      "what_is_your_gender",
                      "what_is_your_age",
                      "do_you_work_right_now_or_have_you_worked_in_the_last_year",
                      "in_what_job_industry_was_is_this_work",
                      "how_many_years_of_experience_do_you_have_in_your_current_last_years_job_numbers_only",
                      "what_is_the_highest_level_of_education_that_you_have_completed",
                      "what_is_your_type_of_employment")

# Select the columns of interest
data <- data %>% 
  dplyr::select(all_of(selected_columns))

# Rename the selected columns
data <- data %>%
  rename(location = in_what_kind_of_place_do_you_typically_work,
         work_last_4weeks = in_your_main_job_have_you_spent_at_least_one_full_day_in_the_last_four_weeks_working,
         home_work_freq = how_frequently_did_you_work_from_home_in_the_last_four_weeks,
         WLB1 = i_currently_have_a_good_balance_between_the_time_i_spend_at_work_and_the_time_i_have_available_for_non_work_activities,
         WLB2 = i_have_sufficient_time_away_from_my_job_to_maintain_adequate_well_being,
         WLB3 = i_am_satisfied_with_my_work_life_balance,
         WFC1 = my_personal_life_suffers_because_of_work_43,
         WFC2 = when_i_get_home_i_am_often_too_exhausted_to_participate_in_family_activities,
         WFC3 = the_problem_solving_behaviours_i_use_in_my_job_are_not_effective_in_resolving_problems_at_home,
         FWC1 = the_time_i_spend_on_family_responsibilities_often_interferes_with_my_work,
         FWC2 = due_to_stress_at_home_i_am_often_preoccupied_with_family_matters_at_work,
         FWC3 = the_behaviours_that_work_for_me_at_home_do_not_seem_to_be_effective_at_work,
         gender = what_is_your_gender,
         age = what_is_your_age,
         working_status = do_you_work_right_now_or_have_you_worked_in_the_last_year,
         industry = in_what_job_industry_was_is_this_work,
         experience = how_many_years_of_experience_do_you_have_in_your_current_last_years_job_numbers_only,
         education_level = what_is_the_highest_level_of_education_that_you_have_completed,
         employment_type = what_is_your_type_of_employment)

# Check the renamed data
head(data)
```

```{r create working at home variable}
determine_work_type <- function(location, work_last_4weeks, home_work_freq) {
  if (location == 1) {
    return(1)  # Works from Home
  } else if (location %in% 2:8 && work_last_4weeks %in% 1:2 && home_work_freq == 1) {
    return(2)  # Works Hybrid
  } else if (location %in% 2:8 && work_last_4weeks == 3) {
    return(3)  # Works on location
  } else if (location %in% 2:8 && work_last_4weeks %in% 1:2 && home_work_freq == 2) {
    return(3)  # Works on location
  } else {
    return(3)
  }
}

data <- data %>%
  mutate(RW = mapply(determine_work_type, location, work_last_4weeks, home_work_freq)) %>% 
  dplyr::select(-c("location", "work_last_4weeks", "home_work_freq")) %>% 
  na.omit() # removed 4 observations! check if this can be prevented.

# Reverse coding WFC and FWC items
data <- data %>%
  mutate(
    WFC1 = 6 - WFC1,  # Assuming a 5-point scale (1 to 5)
    WFC2 = 6 - WFC2,
    WFC3 = 6 - WFC3,
    FWC1 = 6 - FWC1,
    FWC2 = 6 - FWC2,
    FWC3 = 6 - FWC3
  )
```

```{r crohnbach alpha}

#initialise list of multi-item constructs
constructs <- list(
  WLB = c("WLB1", "WLB2", "WLB3"),
  WFC = c("WFC1", "WFC2", "WFC3"),   
  FWC = c("FWC1", "FWC2", "FWC3"),
  CONFLICTS = c("WFC1", "WFC2", "WFC3", "FWC1", "FWC2", "FWC3")
)

#create function to calculate the alpha
calculate_cronbach_alpha <- function(items) {
  alpha_result <- cronbach.alpha(data[, items], na.rm = TRUE)
  return(alpha_result)
}

#loop
cronbach_results <- lapply(constructs, calculate_cronbach_alpha)

for (construct_name in names(cronbach_results)) {
  cat("Cronbach's Alpha for", construct_name, ":", cronbach_results[[construct_name]]$alpha, "\n")
}
```

The Alpha for WLB and FWC are acceptable, unfortunately WFC does not meet the requirement of at least 0.7. However, when I remove any question, the alpha just gets lowered. Because of that I will accept this bias, and move on with all of these items for WFC.

```{r create the scores}
data <- mutate(data, WLB_score = rowMeans(data[, c("WLB1", "WLB2", "WLB3")], na.rm = TRUE))
data <- mutate(data, WFC_score = rowMeans(data[, c("WFC1", "WFC2", "WFC3")], na.rm = TRUE))
data <- mutate(data, FWC_score = rowMeans(data[, c("FWC1", "FWC2", "FWC3")], na.rm = TRUE))
data <- mutate(data, Conflict_score = rowMeans(data[, c("WFC1", "WFC2", "WFC3", "FWC1", "FWC2", "FWC3")], na.rm = TRUE))
```

```{r H-1: Remote working negatively affects work-life balance by blurring boundaries between work and personal life}
demographics <- "gender + age + education_level + employment_type + industry + experience"

# Perform a linear regression for H-1
model_H1 <- lm(as.formula(paste("WLB_score ~ RW +", demographics)), data = data)
summary(model_H1)

# Check for the significance of the predictor (RW)
anova(model_H1)

# Boxplot to visualize the relationship between remote work type and work-life balance
ggplot(data, aes(x = as.factor(RW), y = WLB_score)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Effect of Remote Working on Work-Life Balance",
       x = "Work Type (1 = Remote, 2 = Hybrid, 3 = On Location)",
       y = "Work-Life Balance Score") +
  theme_minimal()

```

```{r H-2: Remote working will influence work-family conflict negatively}
# Perform a linear regression for H-2
model_H2 <- lm(as.formula(paste("WFC_score ~ RW +", demographics)), data = data)
summary(model_H2)

# Check for significance
anova(model_H2)

# Boxplot to visualize the relationship between remote work type and work-family conflict
ggplot(data, aes(x = as.factor(RW), y = WFC_score)) +
  geom_boxplot(fill = "lightcoral") +
  labs(title = "Effect of Remote Working on Work-Family Conflict",
       x = "Work Type (1 = Remote, 2 = Hybrid, 3 = On Location)",
       y = "Work-Family Conflict Score") +
  theme_minimal()

```

```{r H-3: Work-family conflicts will be negatively correlated with Work-life balance}
# Calculate Pearson correlation for H-3
correlation_H3 <- cor(data$WFC_score, data$WLB_score, use = "complete.obs", method = "pearson")
correlation_H3

# Perform a test of significance for the correlation
cor_test_H3 <- cor.test(data$WFC_score, data$WLB_score, method = "pearson")
cor_test_H3

# Scatter plot to visualize the correlation between work-family conflict and work-life balance
ggplot(data, aes(x = WFC_score, y = WLB_score)) +
  geom_point(color = "blue", alpha = 0.6) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Correlation between Work-Family Conflict and Work-Life Balance",
       x = "Work-Family Conflict Score",
       y = "Work-Life Balance Score") +
  theme_minimal()

```

```{r explanatory graphs}
# Bar plot for gender distribution
ggplot(data, aes(x = factor(gender,
                            levels = c(1, 2, 3, 4),
                            labels = c("Male", "Female", "Non-binary", "Prefer not to say")))) +
  geom_bar(fill = "steelblue") +
  labs(title = "Gender Distribution", x = "Gender", y = "Count") +
  theme_minimal()


# Histogram for age distribution
ggplot(data, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
  labs(title = "Age Distribution", x = "Age", y = "Count") +
  theme_minimal()

# Bar plot for employment type
ggplot(data, aes(x = employment_type)) +
  geom_bar(fill = "lightgreen") +
  labs(title = "Employment Type Distribution", x = "Employment Type", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

# Bar plot for industry
ggplot(data, aes(x = industry)) +
  geom_bar(fill = "coral") +
  labs(title = "Industry Distribution", x = "Industry", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

# Bar plot for education level
ggplot(data, aes(x = factor(education_level,
                            levels = c(1, 2, 3, 4, 5),
                            labels = c("Primary", "Secondary", "Bachelor", "Masters", "Doctorate")))) +
  geom_bar(fill = "lightblue") +
  labs(title = "Education Level Distribution", x = "Education Level", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

```





---
title: "Analysis Business Research"
author: "Melle Stephen Oudshoorn"
date: "`r Sys.Date()`"
output: html_document
---

```{r loading packages}
library(dplyr)
library(readxl)
library(tidyr)
library(readr)
library(ggplot2)
library(ltm)
```

```{r load and mutate data}
data <- read_excel("Master File.xlsx")

# Mutate dataframe for the questions of interest:

data <- data %>% 
  #select questions of interest
  select(c("In what kind of place do you typically work?",
           "(In your main job) have you spent at least one full day in the last four weeks working...",
           "How frequently did you work from home in the last four weeks?",
           "I currently have a good balance between the time I spend at work and the time I have available for non-work activities.",
           "I have sufficient time away from my job to maintain adequate well-being.",
           "I am satisfied with my work-life balance.",
           "My personal life suffers because of work....43",
           "When I get home I am often too exhausted to participate in family activities.",
           "The problem-solving behaviours I use in my job are not effective in resolving problems at home.",
           "The time i spend on family responsibilities often interferes with my work.",
           "Due to stress at home, I am often preoccupied with family matters at work.",
           "The behaviours that work for me at home do not seem to be effective at work.",
           "What is your gender?",
           "What is your age?",
           "Do you work right now, or have you worked in the last year?",
           "In what job industry was/is this work?",
           "How many years of experience do you have in your (current/last years) job? (numbers only)",
           "What is the highest level of education that you have completed?",
           "What is your type of employment?"
           )) %>% 
  #rename these variables
  rename(location = "In what kind of place do you typically work?",
         work_last_4weeks = "(In your main job) have you spent at least one full day in the last four weeks working...",
         home_work_freq = "How frequently did you work from home in the last four weeks?",
         WLB1 = "I currently have a good balance between the time I spend at work and the time I have available for non-work activities.",
         WLB2 = "I have sufficient time away from my job to maintain adequate well-being.",
         WLB3 = "I am satisfied with my work-life balance.",
         WFC1 = "My personal life suffers because of work....43",
         WFC2 = "When I get home I am often too exhausted to participate in family activities.",
         WFC3 = "The problem-solving behaviours I use in my job are not effective in resolving problems at home.",
         FWC1 = "The time i spend on family responsibilities often interferes with my work.",
         FWC2 = "Due to stress at home, I am often preoccupied with family matters at work.",
         FWC3 = "The behaviours that work for me at home do not seem to be effective at work.",
         gender = "What is your gender?",
         age = "What is your age?",
         working_status = "Do you work right now, or have you worked in the last year?",
         industry = "In what job industry was/is this work?",
         experience = "How many years of experience do you have in your (current/last years) job? (numbers only)",
         education_level = "What is the highest level of education that you have completed?",
         employment_type = "What is your type of employment?"
  )

```

```{r create working at home variable}
determine_work_type <- function(location, work_last_4weeks, home_work_freq) {
  if (location == 1) {
    return(1)  # Works from Home
  } else if (location %in% 2:8 && work_last_4weeks %in% 1:2 && home_work_freq == 1) {
    return(2)  # Works Hybrid
  } else if (location %in% 2:8 && work_last_4weeks == 3) {
    return(3)  # Works on location
  } else if (location %in% 2:8 && work_last_4weeks %in% 1:2 && home_work_freq == 2) {
    return(3)  # Works on location
  } else {
    return(3)
  }
}

data <- data %>%
  mutate(RW = mapply(determine_work_type, location, work_last_4weeks, home_work_freq)) %>% 
  select(-c("location", "work_last_4weeks", "home_work_freq")) %>% 
  na.omit() # removed 4 observations! check if this can be prevented.

# Reverse coding WFC and FWC items
data <- data %>%
  mutate(
    WFC1 = 6 - WFC1,  # Assuming a 5-point scale (1 to 5)
    WFC2 = 6 - WFC2,
    WFC3 = 6 - WFC3,
    FWC1 = 6 - FWC1,
    FWC2 = 6 - FWC2,
    FWC3 = 6 - FWC3
  )
```

```{r crohnbach alpha}

#initialise list of multi-item constructs
constructs <- list(
  WLB = c("WLB1", "WLB2", "WLB3"),
  WFC = c("WFC1", "WFC2", "WFC3"),   
  FWC = c("FWC1", "FWC2", "FWC3"),
  CONFLICTS = c("WFC1", "WFC2", "WFC3", "FWC1", "FWC2", "FWC3")
)

#create function to calculate the alpha
calculate_cronbach_alpha <- function(items) {
  alpha_result <- cronbach.alpha(data[, items], na.rm = TRUE)
  return(alpha_result)
}

#loop
cronbach_results <- lapply(constructs, calculate_cronbach_alpha)

for (construct_name in names(cronbach_results)) {
  cat("Cronbach's Alpha for", construct_name, ":", cronbach_results[[construct_name]]$alpha, "\n")
}
```

The Alpha for WLB and FWC are acceptable, unfortunately WFC does not meet the requirement of at least 0.7. However, when I remove any question, the alpha just gets lowered. Because of that I will accept this bias, and move on with all of these items for WFC.

```{r create the scores}
data <- mutate(data, WLB_score = rowMeans(data[, c("WLB1", "WLB2", "WLB3")], na.rm = TRUE))
data <- mutate(data, WFC_score = rowMeans(data[, c("WFC1", "WFC2", "WFC3")], na.rm = TRUE))
data <- mutate(data, FWC_score = rowMeans(data[, c("FWC1", "FWC2", "FWC3")], na.rm = TRUE))
data <- mutate(data, Conflict_score = rowMeans(data[, c("WFC1", "WFC2", "WFC3", "FWC1", "FWC2", "FWC3")], na.rm = TRUE))
```


```{r explanatory graphs}
# Bar plot for gender distribution
ggplot(data, aes(x = factor(gender,
                            levels = c(1, 2, 3, 4),
                            labels = c("Male", "Female", "Non-binary", "Prefer not to say")))) +
  geom_bar(fill = "steelblue") +
  labs(title = "Gender Distribution", x = "Gender", y = "Count") +
  theme_minimal()


# Histogram for age distribution
ggplot(data, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
  labs(title = "Age Distribution", x = "Age", y = "Count") +
  theme_minimal()

# Bar plot for employment type
ggplot(data, aes(x = employment_type)) +
  geom_bar(fill = "lightgreen") +
  labs(title = "Employment Type Distribution", x = "Employment Type", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

# Bar plot for industry
ggplot(data, aes(x = industry)) +
  geom_bar(fill = "coral") +
  labs(title = "Industry Distribution", x = "Industry", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

# Bar plot for education level
ggplot(data, aes(x = factor(education_level,
                            levels = c(1, 2, 3, 4, 5),
                            labels = c("Primary", "Secondary", "Bachelor", "Masters", "Doctorate")))) +
  geom_bar(fill = "lightblue") +
  labs(title = "Education Level Distribution", x = "Education Level", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

```




